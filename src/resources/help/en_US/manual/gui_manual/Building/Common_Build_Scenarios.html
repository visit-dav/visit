

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>18.3. Common Build Scenarios &mdash; VisIt User Manual 2.11 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="VisIt User Manual 2.11 documentation" href="../../index.html"/>
        <link rel="up" title="18. Building" href="index.html"/>
        <link rel="next" title="19. Building on Windows" href="../BuildingOnWindows/index.html"/>
        <link rel="prev" title="18.2. Advanced Usage" href="Advanced_Usage.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> VisIt User Manual
          

          
          </a>

          
            
            
              <div class="version">
                local build
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">GUI Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Intro/index.html">1. Introduction to VisIt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../WorkingWithFiles/index.html">2. Working with Databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Plots/index.html">3. Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Operators/index.html">4. Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SavingPrinting/index.html">5. Saving and Printing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../VisualizationWindows/index.html">6. Visualization Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Subsetting/index.html">7. Subsetting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Quantitative/index.html">8. Quantitative Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MakingItPretty/index.html">9. Making it pretty</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Animation/index.html">10. Animation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../InteractiveTools/index.html">11. Interactive Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MultipleDatabaseAndWindows/index.html">12. Multiple Databases and Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ClientServer/index.html">13. Client Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ComputeEngines/index.html">14. Compute Engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Preferences/index.html">15. Preferences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Help/index.html">16. Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../StartupOptions/index.html">17. Startup Options</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">18. Building</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Basic_Usage.html">18.1. Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="Advanced_Usage.html">18.2. Advanced Usage</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">18.3. Common Build Scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kickit-a-redhat-enterprise-linux-7-system">18.3.1. Kickit, a RedHat Enterprise Linux 7 system</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quartz-a-linux-x86-64-toss3-cluster">18.3.2. Quartz, a Linux X86_64 TOSS3 cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lassen-a-linux-power9-blueos-cluster">18.3.3. Lassen, a Linux Power9 BlueOS cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cori-a-cray-knl-cluster">18.3.4. Cori, a Cray KNL cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="#summit-a-linux-power9-blueos-cluster">18.3.5. Summit, a Linux Power9 BlueOS cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trinity-a-cray-knl-cluster">18.3.6. Trinity, a Cray KNL cluster</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../BuildingOnWindows/index.html">19. Building on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Acknowledgments/index.html">20. Acknowledgments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../glossary.html">21. Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Contributing/index.html">22. Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cli_manual/index.html">CLI Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev_manual/index.html">Developer Manual</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">VisIt User Manual</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">VisIt GUI User Manual</a> &raquo;</li>
        
          <li><a href="index.html">18. Building</a> &raquo;</li>
        
      <li>18.3. Common Build Scenarios</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/gui_manual/Building/Common_Build_Scenarios.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="common-build-scenarios">
<span id="id1"></span><h1>18.3. Common Build Scenarios<a class="headerlink" href="#common-build-scenarios" title="Permalink to this headline">¶</a></h1>
<p>Building <a class="reference external" href="https://visit.llnl.gov">VisIt</a> is an involved process and even with <code class="docutils literal notranslate"><span class="pre">build_visit</span></code>,
just determining the correct selection of options can sometimes be
daunting. To help, here are the steps used to build <a class="reference external" href="https://visit.llnl.gov">VisIt</a> on a collection
of different platforms that may serve as a starting point for your system.</p>
<p>In each of the scenarios below, the result is a distribution file that can
be used with <code class="docutils literal notranslate"><span class="pre">visit-install</span></code> to install <a class="reference external" href="https://visit.llnl.gov">VisIt</a>. Furthermore, in all these
scenarios, <code class="docutils literal notranslate"><span class="pre">build_visit</span></code> was used to build the third party libraries and
the initial config site file. <a class="reference external" href="https://visit.llnl.gov">VisIt</a> was then manually built as outlined
by doing an out of source build. The advantage to building <a class="reference external" href="https://visit.llnl.gov">VisIt</a> manually
is that you have more control over the build and its easier to troubleshoot
failures. The advantage to an out of source build is that you can easily
restart the build simply by deleting the build directory.</p>
<div class="section" id="kickit-a-redhat-enterprise-linux-7-system">
<h2>18.3.1. Kickit, a RedHat Enterprise Linux 7 system<a class="headerlink" href="#kickit-a-redhat-enterprise-linux-7-system" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">build_visit</span></code> was run to generate the third party libraries. In this
case all the required and optional libraries build without problem, so
<code class="docutils literal notranslate"><span class="pre">--required</span> <span class="pre">--optional</span></code> could be used. Also, in this case there wasn’t
a system MPI installed so <code class="docutils literal notranslate"><span class="pre">--mpich</span></code> was specified to use MPICH. The
<code class="docutils literal notranslate"><span class="pre">--osmesa</span></code> flag was also included so that VisIt could do off screen
rendering.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">build_visit3_0_1</span> <span class="o">--</span><span class="n">required</span> <span class="o">--</span><span class="n">optional</span> <span class="o">--</span><span class="n">mpich</span> <span class="o">--</span><span class="n">osmesa</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">visit</span> \
<span class="o">--</span><span class="n">thirdparty</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">gapps</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span> <span class="o">--</span><span class="n">makeflags</span> <span class="o">-</span><span class="n">j4</span>
</pre></div>
</div>
<p>This built the third party libraries and generated a <code class="docutils literal notranslate"><span class="pre">kickit.cmake</span></code>
config site file. The <code class="docutils literal notranslate"><span class="pre">Setup</span> <span class="pre">VISITHOME</span> <span class="pre">&amp;</span> <span class="pre">VISITARCH</span> <span class="pre">variables.</span></code> section
was changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Setup VISITHOME &amp; VISITARCH variables.</span>
<span class="c1">##</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITHOME</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">gapps</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITARCH</span> <span class="n">linux</span><span class="o">-</span><span class="n">x86_64_gcc</span><span class="o">-</span><span class="mf">4.8</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_SLIVR</span> <span class="n">TRUE</span> <span class="n">TYPE</span> <span class="n">BOOL</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="https://visit.llnl.gov">VisIt</a> was then manually built with the following steps.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="n">zxf</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cp</span> <span class="n">kickit</span><span class="o">.</span><span class="n">cmake</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">config</span><span class="o">-</span><span class="n">site</span>
<span class="n">cd</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">gapps</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="mf">3.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">x86_64_gcc</span><span class="o">-</span><span class="mf">4.8</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cmake</span> \
<span class="o">../</span><span class="n">src</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">Release</span> \
<span class="o">-</span><span class="n">DVISIT_INSTALL_THIRD_PARTY</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span> \
<span class="o">-</span><span class="n">DVISIT_ENABLE_XDB</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">DVISIT_PARADIS</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">4</span> <span class="n">package</span>
</pre></div>
</div>
</div>
<div class="section" id="quartz-a-linux-x86-64-toss3-cluster">
<h2>18.3.2. Quartz, a Linux X86_64 TOSS3 cluster<a class="headerlink" href="#quartz-a-linux-x86-64-toss3-cluster" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">build_visit</span></code> was run to generate the third party libraries. In this
case the system MPI was used, so information about the system MPI had to
be provided with environment variables and the <code class="docutils literal notranslate"><span class="pre">--parallel</span></code> flag had
to be specified. In this case, all the required and optional third party
libraries build without problem, so <code class="docutils literal notranslate"><span class="pre">--required</span> <span class="pre">--optional</span></code> could be
used. Also, the system OpenGL implementation was outdated and <code class="docutils literal notranslate"><span class="pre">--mesagl</span></code>
had to be included to provide an OpenGL implementation suitable for
<a class="reference external" href="https://visit.llnl.gov">VisIt</a>. Lastly, the Uintah library was built to enable building the
Uintah reader.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="n">PAR_COMPILER</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">tce</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">mvapich2</span><span class="o">/</span><span class="n">mvapich2</span><span class="o">-</span><span class="mf">2.3</span><span class="o">-</span><span class="n">gcc</span><span class="o">-</span><span class="mf">4.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mpicc</span> \
    <span class="n">PAR_COMPILER_CXX</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">tce</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">mvapich2</span><span class="o">/</span><span class="n">mvapich2</span><span class="o">-</span><span class="mf">2.3</span><span class="o">-</span><span class="n">gcc</span><span class="o">-</span><span class="mf">4.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mpicxx</span> \
    <span class="n">PAR_INCLUDE</span><span class="o">=-</span><span class="n">I</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">tce</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">mvapich2</span><span class="o">/</span><span class="n">mvapich2</span><span class="o">-</span><span class="mf">2.3</span><span class="o">-</span><span class="n">gcc</span><span class="o">-</span><span class="mf">4.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">include</span> \
    <span class="n">PAR_LIBS</span><span class="o">=-</span><span class="n">lmpl</span> \
<span class="o">./</span><span class="n">build_visit3_0_1</span> <span class="o">--</span><span class="n">required</span> <span class="o">--</span><span class="n">optional</span> <span class="o">--</span><span class="n">mesagl</span> <span class="o">--</span><span class="n">uintah</span> <span class="o">--</span><span class="n">parallel</span> \
<span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">visit</span> <span class="o">--</span><span class="n">thirdparty</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">wsa</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">toss3</span> \
<span class="o">--</span><span class="n">makeflags</span> <span class="o">-</span><span class="n">j16</span>
</pre></div>
</div>
<p>This built the third party libraries and generated a <code class="docutils literal notranslate"><span class="pre">quartz386.cmake</span></code>
config site file. The <code class="docutils literal notranslate"><span class="pre">Setup</span> <span class="pre">VISITHOME</span> <span class="pre">&amp;</span> <span class="pre">VISITARCH</span> <span class="pre">variables.</span></code> section
was changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Setup VISITHOME &amp; VISITARCH variables.</span>
<span class="c1">##</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITHOME</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">gapps</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITARCH</span> <span class="n">linux</span><span class="o">-</span><span class="n">x86_64_gcc</span><span class="o">-</span><span class="mf">4.8</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_SLIVR</span> <span class="n">TRUE</span> <span class="n">TYPE</span> <span class="n">BOOL</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Parallel</span> <span class="pre">build</span> <span class="pre">Setup.</span></code> section was changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Parallel Build Setup.</span>
<span class="c1">##</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_PARALLEL</span> <span class="n">ON</span> <span class="n">TYPE</span> <span class="n">BOOL</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_CXX_FLAGS</span> <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">tce</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">mvapich2</span><span class="o">/</span><span class="n">mvapich2</span><span class="o">-</span><span class="mf">2.3</span><span class="o">-</span><span class="n">gcc</span><span class="o">-</span><span class="mf">4.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">include</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_C_FLAGS</span>   <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">tce</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">mvapich2</span><span class="o">/</span><span class="n">mvapich2</span><span class="o">-</span><span class="mf">2.3</span><span class="o">-</span><span class="n">gcc</span><span class="o">-</span><span class="mf">4.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">include</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_LD_FLAGS</span>  <span class="s2">&quot;-L/usr/tce/packages/mvapich2/mvapich2-2.3-gcc-4.9.3/lib -Wl,-rpath=/usr/tce/packages/mvapich2/mvapich2-2.3-gcc-4.9.3/lib&quot;</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_LIBS</span>     <span class="n">mpich</span> <span class="n">mpl</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_PARALLEL_RPATH</span>  <span class="s2">&quot;/usr/tce/packages/mvapich2/mvapich2-2.3-gcc-4.9.3/lib&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="https://visit.llnl.gov">VisIt</a> was then manually built with the following steps.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="n">zxf</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cp</span> <span class="n">kickit</span><span class="o">.</span><span class="n">cmake</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">config</span><span class="o">-</span><span class="n">site</span>
<span class="n">cd</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">wsa</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">toss3</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="mf">3.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">x86_64_gcc</span><span class="o">-</span><span class="mf">4.9</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cmake</span> \
<span class="o">../</span><span class="n">src</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">Release</span> \
<span class="o">-</span><span class="n">DVISIT_INSTALL_THIRD_PARTY</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">DVISIT_PARADIS</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">16</span> <span class="n">package</span>
</pre></div>
</div>
</div>
<div class="section" id="lassen-a-linux-power9-blueos-cluster">
<h2>18.3.3. Lassen, a Linux Power9 BlueOS cluster<a class="headerlink" href="#lassen-a-linux-power9-blueos-cluster" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">build_visit</span></code> was run to generate the third party libraries. In this
case the system MPI was used, so information about the system MPI had to
be provided with environment variables and the <code class="docutils literal notranslate"><span class="pre">--parallel</span></code> flag had
to be specified. In this case, a few of the optional third party libraries
do not build on the system so all the desired optional third party libraries
had to be explicitly listed. Also, the system OpenGL implementation was
outdated and <code class="docutils literal notranslate"><span class="pre">--mesagl</span></code> had to be included to provide an OpenGL
implementation suitable for <a class="reference external" href="https://visit.llnl.gov">VisIt</a>. Lastly, the Uintah library was built
to enable building the Uintah reader.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="n">PAR_COMPILER</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">tce</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">-</span><span class="n">rolling</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">gcc</span><span class="o">-</span><span class="mf">4.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mpicc</span> \
 <span class="n">PAR_COMPILER_CXX</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">tce</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">-</span><span class="n">rolling</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">gcc</span><span class="o">-</span><span class="mf">4.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mpicxx</span> \
 <span class="n">PAR_INCLUDE</span><span class="o">=-</span><span class="n">I</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">tce</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">/</span><span class="n">ibm</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">-</span><span class="n">rolling</span><span class="o">-</span><span class="n">release</span><span class="o">/</span><span class="n">include</span> \
 <span class="o">./</span><span class="n">build_visit3_0_1</span> \
 <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">thirdparty</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">visit</span> \
 <span class="o">--</span><span class="n">cmake</span> <span class="o">--</span><span class="n">python</span> <span class="o">--</span><span class="n">vtk</span> <span class="o">--</span><span class="n">qt</span> <span class="o">--</span><span class="n">qwt</span> \
 <span class="o">--</span><span class="n">adios</span> <span class="o">--</span><span class="n">adios2</span> <span class="o">--</span><span class="n">advio</span> <span class="o">--</span><span class="n">boost</span> <span class="o">--</span><span class="n">cfitsio</span> <span class="o">--</span><span class="n">cgns</span> <span class="o">--</span><span class="n">conduit</span> \
 <span class="o">--</span><span class="n">gdal</span> <span class="o">--</span><span class="n">glu</span> <span class="o">--</span><span class="n">h5part</span> <span class="o">--</span><span class="n">hdf5</span> <span class="o">--</span><span class="n">icet</span> <span class="o">--</span><span class="n">llvm</span> <span class="o">--</span><span class="n">mfem</span> \
 <span class="o">--</span><span class="n">mili</span> <span class="o">--</span><span class="n">moab</span> <span class="o">--</span><span class="n">mxml</span> <span class="o">--</span><span class="n">netcdf</span> <span class="o">--</span><span class="n">openssl</span> <span class="o">--</span><span class="n">p7zip</span> \
 <span class="o">--</span><span class="n">silo</span> <span class="o">--</span><span class="n">szip</span> <span class="o">--</span><span class="n">vtkm</span> <span class="o">--</span><span class="n">vtkh</span> <span class="o">--</span><span class="n">xdmf</span> <span class="o">--</span><span class="n">zlib</span> \
 <span class="o">--</span><span class="n">mesagl</span> <span class="o">--</span><span class="n">uintah</span> <span class="o">--</span><span class="n">parallel</span> \
 <span class="o">--</span><span class="n">thirdparty</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">wsa</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">blueos</span> \
 <span class="o">--</span><span class="n">makeflags</span> <span class="o">-</span><span class="n">j16</span>
</pre></div>
</div>
<p>This built the third party libraries and generated a <code class="docutils literal notranslate"><span class="pre">lassen708.cmake</span></code>
config site file. The <code class="docutils literal notranslate"><span class="pre">Setup</span> <span class="pre">VISITHOME</span> <span class="pre">&amp;</span> <span class="pre">VISITARCH</span> <span class="pre">variables.</span></code> section
was changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Setup VISITHOME &amp; VISITARCH variables.</span>
<span class="c1">##</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITHOME</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">wsa</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">blueos</span><span class="p">)</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITARCH</span> <span class="n">linux</span><span class="o">-</span><span class="n">ppc64le_gcc</span><span class="o">-</span><span class="mf">4.9</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_SLIVR</span> <span class="n">TRUE</span> <span class="n">TYPE</span> <span class="n">BOOL</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Parallel</span> <span class="pre">build</span> <span class="pre">Setup.</span></code> section was changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Parallel Build Setup.</span>
<span class="c1">##</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_PARALLEL</span> <span class="n">ON</span> <span class="n">TYPE</span> <span class="n">BOOL</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_CXX_FLAGS</span> <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">tce</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">/</span><span class="n">ibm</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">-</span><span class="n">rolling</span><span class="o">-</span><span class="n">release</span><span class="o">/</span><span class="n">include</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_C_FLAGS</span>   <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">tce</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">/</span><span class="n">ibm</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">-</span><span class="n">rolling</span><span class="o">-</span><span class="n">release</span><span class="o">/</span><span class="n">include</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_LD_FLAGS</span>  <span class="s2">&quot;-L/usr/tce/packages/spectrum-mpi/ibm/spectrum-mpi-rolling-release/lib -Wl,-rpath=/usr/tce/packages/spectrum-mpi/ibm/spectrum-mpi-rolling-release/lib&quot;</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_LIBS</span>     <span class="n">mpi_ibm</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_PARALLEL_RPATH</span>  <span class="s2">&quot;/usr/tce/packages/spectrum-mpi/ibm/spectrum-mpi-rolling-release/lib&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="https://visit.llnl.gov">VisIt</a> was then manually built with the following steps.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="n">zxf</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cp</span> <span class="n">lassen708</span><span class="o">.</span><span class="n">cmake</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">config</span><span class="o">-</span><span class="n">site</span>
<span class="n">cd</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">wsa</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">blueos</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="mf">3.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">ppc64le_gcc</span><span class="o">-</span><span class="mf">4.9</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cmake</span> \
<span class="o">../</span><span class="n">src</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">Release</span> \
<span class="o">-</span><span class="n">DVISIT_INSTALL_THIRD_PARTY</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">16</span> <span class="n">package</span>
</pre></div>
</div>
</div>
<div class="section" id="cori-a-cray-knl-cluster">
<h2>18.3.4. Cori, a Cray KNL cluster<a class="headerlink" href="#cori-a-cray-knl-cluster" title="Permalink to this headline">¶</a></h2>
<p>The system is set up to support the Intel compiler by default so we need
to swap out the Intel environment for the GNU environment.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">swap</span> <span class="n">PrgEnv</span><span class="o">-</span><span class="n">intel</span><span class="o">/</span><span class="mf">6.0</span><span class="o">.</span><span class="mi">4</span> <span class="n">PrgEnv</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="mf">6.0</span><span class="o">.</span><span class="mi">4</span>
</pre></div>
</div>
<p>The Cray compiler wrappers are set up to do static linking, which causes
a problem with building parallel hdf5. The linking can be changed to
link dynamically by setting a couple of environment variables.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">XTPE_LINK_TYPE</span><span class="o">=</span><span class="n">dynamic</span>
<span class="n">export</span> <span class="n">CRAYPE_LINK_TYPE</span><span class="o">=</span><span class="n">dynamic</span>
</pre></div>
</div>
<p>The linker has a bug that prevents VTK from building, which is fixed with
the linker in binutils 2.32. Binutils was then manually built with the
following steps.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="o">.</span><span class="n">ocf</span><span class="o">.</span><span class="n">berkeley</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">gnu</span><span class="o">/</span><span class="n">binutils</span><span class="o">/</span><span class="n">binutils</span><span class="o">-</span><span class="mf">2.32</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">mkdir</span> <span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">projectdirs</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">binutils</span>
<span class="n">tar</span> <span class="n">zxf</span> <span class="n">binutils</span><span class="o">-</span><span class="mf">2.32</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">binutils</span><span class="o">-</span><span class="mf">2.32</span>
<span class="o">./</span><span class="n">configure</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=/</span><span class="n">project</span><span class="o">/</span><span class="n">projectdirs</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">binutils</span>
<span class="n">make</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>The following lines in <code class="docutils literal notranslate"><span class="pre">build_visit</span></code></p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vopts</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{vopts}</span><span class="s2"> -DCMAKE_C_FLAGS:STRING=</span><span class="se">\&quot;</span><span class="s2">$</span><span class="si">{C_OPT_FLAGS}</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
<span class="n">vopts</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{vopts}</span><span class="s2"> -DCMAKE_CXX_FLAGS:STRING=</span><span class="se">\&quot;</span><span class="s2">$</span><span class="si">{CXX_OPT_FLAGS}</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>were changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vopts</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{vopts}</span><span class="s2"> -DCMAKE_C_FLAGS:STRING=</span><span class="se">\&quot;</span><span class="s2">$</span><span class="si">{C_OPT_FLAGS}</span><span class="s2"> -B/project/projectdirs/visit/thirdparty_shared/3.0.1/binutils/bin</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
<span class="n">vopts</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{vopts}</span><span class="s2"> -DCMAKE_CXX_FLAGS:STRING=</span><span class="se">\&quot;</span><span class="s2">$</span><span class="si">{CXX_OPT_FLAGS}</span><span class="s2"> -B/project/projectdirs/visit/thirdparty_shared/3.0.1/binutils/bin</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>to build VTK with the linker from binutils 2.32.</p>
<p><code class="docutils literal notranslate"><span class="pre">build_visit</span></code> was run to generate the third party libraries. In this
case the system MPI was used, so information about the system MPI had to
be provided with environment variables and the <code class="docutils literal notranslate"><span class="pre">--parallel</span></code> flag had
to be specified. In this case, all the required and optional third party
libraries built without problem, so <code class="docutils literal notranslate"><span class="pre">--required</span> <span class="pre">--optional</span></code> could be
used. Also, the system OpenGL implementation was outdated and <code class="docutils literal notranslate"><span class="pre">--mesagl</span></code>
had to be included to provide an OpenGL implementation suitable for
<a class="reference external" href="https://visit.llnl.gov">VisIt</a>. Lastly, the Uintah library was built to enable building the
Uintah reader.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="n">PAR_COMPILER</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">cray</span><span class="o">/</span><span class="n">pe</span><span class="o">/</span><span class="n">craype</span><span class="o">/</span><span class="mf">2.5</span><span class="o">.</span><span class="mi">15</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cc</span> \
    <span class="n">PAR_COMPILER_CXX</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">cray</span><span class="o">/</span><span class="n">pe</span><span class="o">/</span><span class="n">craype</span><span class="o">/</span><span class="mf">2.5</span><span class="o">.</span><span class="mi">15</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">CC</span> \
    <span class="n">PAR_INCLUDE</span><span class="o">=-</span><span class="n">I</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">cray</span><span class="o">/</span><span class="n">pe</span><span class="o">/</span><span class="n">mpt</span><span class="o">/</span><span class="mf">7.7</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">gni</span><span class="o">/</span><span class="n">mpich</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="mf">7.1</span><span class="o">/</span><span class="n">include</span> \
    <span class="n">PAR_LIBS</span><span class="o">=</span><span class="s2">&quot;-L/opt/cray/pe/mpt/7.7.3/gni/mpich-gnu/7.1/lib -Wl,-rpath=/opt/cray/pe/mpt/7.7.3/gni/mpich-gnu/7.1/lib -lmpich&quot;</span> \
 <span class="o">./</span><span class="n">build_visit3_0_1</span> <span class="o">--</span><span class="n">required</span> <span class="o">--</span><span class="n">optional</span> <span class="o">--</span><span class="n">mesagl</span> <span class="o">--</span><span class="n">uintah</span> <span class="o">--</span><span class="n">parallel</span> \
 <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">visit</span> <span class="o">--</span><span class="n">thirdparty</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">projectdirs</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span> \
 <span class="o">--</span><span class="n">makeflags</span> <span class="o">-</span><span class="n">j8</span>
</pre></div>
</div>
<p>This built the third party libraries and generated a <code class="docutils literal notranslate"><span class="pre">cori08.cmake</span></code>
config site file. The <code class="docutils literal notranslate"><span class="pre">Setup</span> <span class="pre">VISITHOME</span> <span class="pre">&amp;</span> <span class="pre">VISITARCH</span> <span class="pre">variables.</span></code> section
was changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Setup VISITHOME &amp; VISITARCH variables.</span>
<span class="c1">##</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITHOME</span> <span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">projectdirs</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITARCH</span> <span class="n">linux</span><span class="o">-</span><span class="n">x86_64_gcc</span><span class="o">-</span><span class="mf">7.3</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_SLIVR</span> <span class="n">TRUE</span> <span class="n">TYPE</span> <span class="n">BOOL</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">VISIT_C_FLAGS</span></code> and <code class="docutils literal notranslate"><span class="pre">VISIT_CXX_FLAGS</span></code> were changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_C_FLAGS</span> <span class="s2">&quot; -m64 -fPIC -fvisibility=hidden -B/project/projectdirs/visit/thirdparty_shared/3.0.1/binutils/bin&quot;</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_CXX_FLAGS</span> <span class="s2">&quot; -m64 -fPIC -fvisibility=hidden -B/project/projectdirs/visit/thirdparty_shared/3.0.1/binutils/bin&quot;</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Parallel</span> <span class="pre">build</span> <span class="pre">Setup.</span></code> section was changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Parallel Build Setup.</span>
<span class="c1">##</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_PARALLEL</span> <span class="n">ON</span> <span class="n">TYPE</span> <span class="n">BOOL</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_CXX_FLAGS</span> <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">cray</span><span class="o">/</span><span class="n">pe</span><span class="o">/</span><span class="n">mpt</span><span class="o">/</span><span class="mf">7.7</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">gni</span><span class="o">/</span><span class="n">mpich</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="mf">7.1</span><span class="o">/</span><span class="n">include</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_C_FLAGS</span>   <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">cray</span><span class="o">/</span><span class="n">pe</span><span class="o">/</span><span class="n">mpt</span><span class="o">/</span><span class="mf">7.7</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">gni</span><span class="o">/</span><span class="n">mpich</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="mf">7.1</span><span class="o">/</span><span class="n">include</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_LD_FLAGS</span>  <span class="s2">&quot;-L/opt/cray/pe/mpt/7.7.3/gni/mpich-gnu/7.1/lib -Wl,-rpath=/opt/cray/pe/mpt/7.7.3/gni/mpich-gnu/7.1/lib&quot;</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_LIBS</span>     <span class="n">mpich</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_PARALLEL_RPATH</span>  <span class="s2">&quot;/opt/cray/pe/mpt/7.7.3/gni/mpich-gnu/7.1/lib&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="https://visit.llnl.gov">VisIt</a> was then manually built with the following steps.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="n">zxf</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cp</span> <span class="n">cori08</span><span class="o">.</span><span class="n">cmake</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">config</span><span class="o">-</span><span class="n">site</span>
<span class="n">cd</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">projectdirs</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="mf">3.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">x86_64_gcc</span><span class="o">-</span><span class="mf">7.3</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cmake</span> \
<span class="o">../</span><span class="n">src</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">Release</span> \
<span class="o">-</span><span class="n">DVISIT_INSTALL_THIRD_PARTY</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">DVISIT_PARADIS</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">8</span> <span class="n">package</span>
</pre></div>
</div>
</div>
<div class="section" id="summit-a-linux-power9-blueos-cluster">
<h2>18.3.5. Summit, a Linux Power9 BlueOS cluster<a class="headerlink" href="#summit-a-linux-power9-blueos-cluster" title="Permalink to this headline">¶</a></h2>
<p>The system is set up to support the IBM XL compiler by default so we need
to swap out the XL compiler for the GNU compiler.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">swap</span> <span class="n">xl</span><span class="o">/</span><span class="mf">16.1</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="mi">3</span> <span class="n">gcc</span><span class="o">/</span><span class="mf">6.4</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
<p>There was an error building CMake, so we used the system CMake after
module loading CMake 3.9.2.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">cmake</span><span class="o">/</span><span class="mf">3.9</span><span class="o">.</span><span class="mi">2</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">build_visit</span></code> was run to generate the third party libraries. In this
case the system MPI was used, so information about the system MPI had to
be provided with environment variables and the <code class="docutils literal notranslate"><span class="pre">--parallel</span></code> flag had
to be specified. In this case, a few of the optional third party libraries
do not build on the system so all the desired optional third party libraries
had to be explicitly listed. Also, the system OpenGL implementation was
outdated and <code class="docutils literal notranslate"><span class="pre">--mesagl</span></code> had to be included to provide an OpenGL
implementation suitable for <a class="reference external" href="https://visit.llnl.gov">VisIt</a>. Lastly, the Uintah library was built
to enable building the Uintah reader.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="n">PAR_COMPILER</span><span class="o">=/</span><span class="n">autofs</span><span class="o">/</span><span class="n">nccs</span><span class="o">-</span><span class="n">svm1_sw</span><span class="o">/</span><span class="n">summit</span><span class="o">/.</span><span class="n">swci</span><span class="o">/</span><span class="mi">1</span><span class="o">-</span><span class="n">compute</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">spack</span><span class="o">/</span><span class="mi">20180914</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">rhel7</span><span class="o">-</span><span class="n">ppc64le</span><span class="o">/</span><span class="n">gcc</span><span class="o">-</span><span class="mf">6.4</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">-</span><span class="mf">10.3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">-</span><span class="mi">20190611</span><span class="o">-</span><span class="n">cyaenjgora6now2nusxzkfli4mzjnudx</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mpicc</span> \
    <span class="n">PAR_COMPILER_CXX</span><span class="o">=/</span><span class="n">autofs</span><span class="o">/</span><span class="n">nccs</span><span class="o">-</span><span class="n">svm1_sw</span><span class="o">/</span><span class="n">summit</span><span class="o">/.</span><span class="n">swci</span><span class="o">/</span><span class="mi">1</span><span class="o">-</span><span class="n">compute</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">spack</span><span class="o">/</span><span class="mi">20180914</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">rhel7</span><span class="o">-</span><span class="n">ppc64le</span><span class="o">/</span><span class="n">gcc</span><span class="o">-</span><span class="mf">6.4</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">-</span><span class="mf">10.3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">-</span><span class="mi">20190611</span><span class="o">-</span><span class="n">cyaenjgora6now2nusxzkfli4mzjnudx</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mpicxx</span> \
    <span class="n">PAR_INCLUDE</span><span class="o">=-</span><span class="n">I</span><span class="o">/</span><span class="n">autofs</span><span class="o">/</span><span class="n">nccs</span><span class="o">-</span><span class="n">svm1_sw</span><span class="o">/</span><span class="n">summit</span><span class="o">/.</span><span class="n">swci</span><span class="o">/</span><span class="mi">1</span><span class="o">-</span><span class="n">compute</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">spack</span><span class="o">/</span><span class="mi">20180914</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">rhel7</span><span class="o">-</span><span class="n">ppc64le</span><span class="o">/</span><span class="n">gcc</span><span class="o">-</span><span class="mf">6.4</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">-</span><span class="mf">10.3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">-</span><span class="mi">20190611</span><span class="o">-</span><span class="n">cyaenjgora6now2nusxzkfli4mzjnudx</span><span class="o">/</span><span class="n">include</span> \
    <span class="o">./</span><span class="n">build_visit3_0_1</span> \
    <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">thirdparty</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">visit</span> \
    <span class="o">--</span><span class="n">system</span><span class="o">-</span><span class="n">cmake</span> <span class="o">--</span><span class="n">python</span> <span class="o">--</span><span class="n">vtk</span> <span class="o">--</span><span class="n">qt</span> <span class="o">--</span><span class="n">qwt</span> \
    <span class="o">--</span><span class="n">adios</span> <span class="o">--</span><span class="n">adios2</span> <span class="o">--</span><span class="n">advio</span> <span class="o">--</span><span class="n">boost</span> <span class="o">--</span><span class="n">cfitsio</span> <span class="o">--</span><span class="n">cgns</span> <span class="o">--</span><span class="n">conduit</span> \
    <span class="o">--</span><span class="n">gdal</span> <span class="o">--</span><span class="n">glu</span> <span class="o">--</span><span class="n">h5part</span> <span class="o">--</span><span class="n">hdf5</span> <span class="o">--</span><span class="n">icet</span> <span class="o">--</span><span class="n">llvm</span> <span class="o">--</span><span class="n">mfem</span> \
    <span class="o">--</span><span class="n">mili</span> <span class="o">--</span><span class="n">moab</span> <span class="o">--</span><span class="n">mxml</span> <span class="o">--</span><span class="n">netcdf</span> <span class="o">--</span><span class="n">openssl</span> <span class="o">--</span><span class="n">p7zip</span> \
    <span class="o">--</span><span class="n">silo</span> <span class="o">--</span><span class="n">szip</span> <span class="o">--</span><span class="n">xdmf</span> <span class="o">--</span><span class="n">zlib</span> \
    <span class="o">--</span><span class="n">mesagl</span> <span class="o">--</span><span class="n">uintah</span> <span class="o">--</span><span class="n">parallel</span> \
    <span class="o">--</span><span class="n">thirdparty</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">autofs</span><span class="o">/</span><span class="n">nccs</span><span class="o">-</span><span class="n">svm1_home1</span><span class="o">/</span><span class="n">brugger1</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span> \
    <span class="o">--</span><span class="n">makeflags</span> <span class="o">-</span><span class="n">j8</span>
</pre></div>
</div>
<p>This built the third party libraries and generated a <code class="docutils literal notranslate"><span class="pre">login1.cmake</span></code>
config site file. The <code class="docutils literal notranslate"><span class="pre">Setup</span> <span class="pre">VISITHOME</span> <span class="pre">&amp;</span> <span class="pre">VISITARCH</span> <span class="pre">variables.</span></code> section
was changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Setup VISITHOME &amp; VISITARCH variables.</span>
<span class="c1">##</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITHOME</span> <span class="o">/</span><span class="n">autofs</span><span class="o">/</span><span class="n">nccs</span><span class="o">-</span><span class="n">svm1_home1</span><span class="o">/</span><span class="n">brugger1</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITARCH</span> <span class="n">linux</span><span class="o">-</span><span class="n">ppc64le_gcc</span><span class="o">-</span><span class="mf">6.4</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_SLIVR</span> <span class="n">TRUE</span> <span class="n">TYPE</span> <span class="n">BOOL</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Parallel</span> <span class="pre">build</span> <span class="pre">Setup.</span></code> section was changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Parallel Build Setup.</span>
<span class="c1">##</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_PARALLEL</span> <span class="n">ON</span> <span class="n">TYPE</span> <span class="n">BOOL</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_CXX_FLAGS</span> <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">autofs</span><span class="o">/</span><span class="n">nccs</span><span class="o">-</span><span class="n">svm1_sw</span><span class="o">/</span><span class="n">summit</span><span class="o">/.</span><span class="n">swci</span><span class="o">/</span><span class="mi">1</span><span class="o">-</span><span class="n">compute</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">spack</span><span class="o">/</span><span class="mi">20180914</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">rhel7</span><span class="o">-</span><span class="n">ppc64le</span><span class="o">/</span><span class="n">gcc</span><span class="o">-</span><span class="mf">6.4</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">-</span><span class="mf">10.3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">-</span><span class="mi">20190611</span><span class="o">-</span><span class="n">cyaenjgora6now2nusxzkfli4mzjnudx</span><span class="o">/</span><span class="n">include</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_C_FLAGS</span>   <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">autofs</span><span class="o">/</span><span class="n">nccs</span><span class="o">-</span><span class="n">svm1_sw</span><span class="o">/</span><span class="n">summit</span><span class="o">/.</span><span class="n">swci</span><span class="o">/</span><span class="mi">1</span><span class="o">-</span><span class="n">compute</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">spack</span><span class="o">/</span><span class="mi">20180914</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">rhel7</span><span class="o">-</span><span class="n">ppc64le</span><span class="o">/</span><span class="n">gcc</span><span class="o">-</span><span class="mf">6.4</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">spectrum</span><span class="o">-</span><span class="n">mpi</span><span class="o">-</span><span class="mf">10.3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">-</span><span class="mi">20190611</span><span class="o">-</span><span class="n">cyaenjgora6now2nusxzkfli4mzjnudx</span><span class="o">/</span><span class="n">include</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_LD_FLAGS</span>  <span class="s2">&quot;-L/autofs/nccs-svm1_sw/summit/.swci/1-compute/opt/spack/20180914/linux-rhel7-ppc64le/gcc-6.4.0/spectrum-mpi-10.3.0.1-20190611-cyaenjgora6now2nusxzkfli4mzjnudx/lib -Wl,-rpath=/autofs/nccs-svm1_sw/summit/.swci/1-compute/opt/spack/20180914/linux-rhel7-ppc64le/gcc-6.4.0/spectrum-mpi-10.3.0.1-20190611-cyaenjgora6now2nusxzkfli4mzjnudx/lib&quot;</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_LIBS</span>     <span class="n">mpi_ibm</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_PARALLEL_RPATH</span>  <span class="s2">&quot;/autofs/nccs-svm1_sw/summit/.swci/1-compute/opt/spack/20180914/linux-rhel7-ppc64le/gcc-6.4.0/spectrum-mpi-10.3.0.1-20190611-cyaenjgora6now2nusxzkfli4mzjnudx/lib&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The compiler didn’t like one of the boost header files, so it was manually
patched.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="o">/</span><span class="n">autofs</span><span class="o">/</span><span class="n">nccs</span><span class="o">-</span><span class="n">svm1_home1</span><span class="o">/</span><span class="n">brugger1</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">boost</span><span class="o">/</span><span class="mi">1_67_0</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">ppc64le_gcc</span><span class="o">-</span><span class="mf">6.4</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">boost</span><span class="o">/</span><span class="n">numeric</span><span class="o">/</span><span class="n">interval</span><span class="o">/</span><span class="n">detail</span><span class="o">/</span><span class="n">ppc_rounding_control</span><span class="o">.</span><span class="n">hpp</span>

<span class="n">line</span> <span class="mi">99</span><span class="p">:</span>
 <span class="n">namespace</span> <span class="n">detail</span> <span class="p">{</span>

 <span class="n">typedef</span> <span class="n">union</span> <span class="p">{</span>
<span class="o">-</span>   <span class="p">::</span><span class="n">boost</span><span class="p">::</span><span class="n">long_long_type</span> <span class="n">imode</span><span class="p">;</span>
<span class="o">+</span>   <span class="p">::</span><span class="n">boost</span><span class="p">::</span><span class="n">ulong_long_type</span> <span class="n">imode</span><span class="p">;</span>
   <span class="n">double</span> <span class="n">dmode</span><span class="p">;</span>
 <span class="p">}</span> <span class="n">rounding_mode_struct</span><span class="p">;</span>
</pre></div>
</div>
<p><a class="reference external" href="https://visit.llnl.gov">VisIt</a> was then manually built with the following steps.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="n">zxf</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cp</span> <span class="n">login1</span><span class="o">.</span><span class="n">cmake</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">config</span><span class="o">-</span><span class="n">site</span>
<span class="n">cd</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="o">/</span><span class="n">autofs</span><span class="o">/</span><span class="n">nccs</span><span class="o">-</span><span class="n">svm1_sw</span><span class="o">/</span><span class="n">summit</span><span class="o">/.</span><span class="n">swci</span><span class="o">/</span><span class="mi">0</span><span class="o">-</span><span class="n">core</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">spack</span><span class="o">/</span><span class="mi">20171006</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">rhel7</span><span class="o">-</span><span class="n">ppc64le</span><span class="o">/</span><span class="n">gcc</span><span class="o">-</span><span class="mf">4.8</span><span class="o">.</span><span class="mi">5</span><span class="o">/</span><span class="n">cmake</span><span class="o">-</span><span class="mf">3.9</span><span class="o">.</span><span class="mi">2</span><span class="o">-</span><span class="n">lnpnk356fyio3b6rq5bdhr2djjirtsxk</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cmake</span> \
<span class="o">../</span><span class="n">src</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">Release</span> \
<span class="o">-</span><span class="n">DVISIT_INSTALL_THIRD_PARTY</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">8</span> <span class="n">package</span>
</pre></div>
</div>
</div>
<div class="section" id="trinity-a-cray-knl-cluster">
<h2>18.3.6. Trinity, a Cray KNL cluster<a class="headerlink" href="#trinity-a-cray-knl-cluster" title="Permalink to this headline">¶</a></h2>
<p>The system is set up to support the Intel compiler by default so we need
to swap out the Intel environment for the GNU environment.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">swap</span> <span class="n">PrgEnv</span><span class="o">-</span><span class="n">intel</span><span class="o">/</span><span class="mf">6.0</span><span class="o">.</span><span class="mi">4</span> <span class="n">PrgEnv</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="mf">6.0</span><span class="o">.</span><span class="mi">4</span>
</pre></div>
</div>
<p>The Cray compiler wrappers are set up to do static linking, which causes
a problem with building parallel hdf5. The linking can be changed to
link dynamically by setting a couple of environment variables.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">XTPE_LINK_TYPE</span><span class="o">=</span><span class="n">dynamic</span>
<span class="n">export</span> <span class="n">CRAYPE_LINK_TYPE</span><span class="o">=</span><span class="n">dynamic</span>
</pre></div>
</div>
<p>The linker has a bug that prevents VTK from building, which is fixed with
the linker in binutils 2.32. Binutils was then manually built with the
following steps.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">mirrors</span><span class="o">.</span><span class="n">ocf</span><span class="o">.</span><span class="n">berkeley</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">gnu</span><span class="o">/</span><span class="n">binutils</span><span class="o">/</span><span class="n">binutils</span><span class="o">-</span><span class="mf">2.32</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">mkdir</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">binutils</span>
<span class="n">tar</span> <span class="n">zxf</span> <span class="n">binutils</span><span class="o">-</span><span class="mf">2.32</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">binutils</span><span class="o">-</span><span class="mf">2.32</span>
<span class="o">./</span><span class="n">configure</span> <span class="o">--</span><span class="n">prefix</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">binutils</span>
<span class="n">make</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>The following lines in <code class="docutils literal notranslate"><span class="pre">build_visit</span></code></p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vopts</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{vopts}</span><span class="s2"> -DCMAKE_C_FLAGS:STRING=</span><span class="se">\&quot;</span><span class="s2">$</span><span class="si">{C_OPT_FLAGS}</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
<span class="n">vopts</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{vopts}</span><span class="s2"> -DCMAKE_CXX_FLAGS:STRING=</span><span class="se">\&quot;</span><span class="s2">$</span><span class="si">{CXX_OPT_FLAGS}</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>were changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vopts</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{vopts}</span><span class="s2"> -DCMAKE_C_FLAGS:STRING=</span><span class="se">\&quot;</span><span class="s2">$</span><span class="si">{C_OPT_FLAGS}</span><span class="s2"> -B/usr/projects/views/visit/thirdparty_shared/3.0.1/binutils/bin</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
<span class="n">vopts</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{vopts}</span><span class="s2"> -DCMAKE_CXX_FLAGS:STRING=</span><span class="se">\&quot;</span><span class="s2">$</span><span class="si">{CXX_OPT_FLAGS}</span><span class="s2"> -B/usr/projects/views/visit/thirdparty_shared/3.0.1/binutils/bin</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>to build VTK with the linker from binutils 2.32.</p>
<p><code class="docutils literal notranslate"><span class="pre">build_visit</span></code> was run to generate the third party libraries. In this
case the system MPI was used, so information about the system MPI had to
be provided with environment variables and the <code class="docutils literal notranslate"><span class="pre">--parallel</span></code> flag had
to be specified. In this case, all the required and optional third party
libraries built without problem, so <code class="docutils literal notranslate"><span class="pre">--required</span> <span class="pre">--optional</span></code> could be
used. Also, the system OpenGL implementation was outdated and <code class="docutils literal notranslate"><span class="pre">--mesagl</span></code>
had to be included to provide an OpenGL implementation suitable for
<a class="reference external" href="https://visit.llnl.gov">VisIt</a>.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">env</span> <span class="n">PAR_COMPILER</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">cray</span><span class="o">/</span><span class="n">pe</span><span class="o">/</span><span class="n">craype</span><span class="o">/</span><span class="mf">2.5</span><span class="o">.</span><span class="mi">16</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cc</span> \
    <span class="n">PAR_COMPILER_CXX</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">cray</span><span class="o">/</span><span class="n">pe</span><span class="o">/</span><span class="n">craype</span><span class="o">/</span><span class="mf">2.5</span><span class="o">.</span><span class="mi">16</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">CC</span> \
    <span class="n">PAR_INCLUDE</span><span class="o">=-</span><span class="n">I</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">cray</span><span class="o">/</span><span class="n">pe</span><span class="o">/</span><span class="n">mpt</span><span class="o">/</span><span class="mf">7.7</span><span class="o">.</span><span class="mi">4</span><span class="o">/</span><span class="n">gni</span><span class="o">/</span><span class="n">mpich</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="mf">7.1</span><span class="o">/</span><span class="n">include</span> \
    <span class="n">PAR_LIBS</span><span class="o">=</span><span class="s2">&quot;-L/opt/cray/pe/mpt/7.7.4/gni/mpich-gnu/7.1/lib -Wl,-rpath=/opt/cray/pe/mpt/7.7.4/gni/mpich-gnu/7.1/lib -lmpich&quot;</span> \
 <span class="o">./</span><span class="n">build_visit3_0_1</span> <span class="o">--</span><span class="n">required</span> <span class="o">--</span><span class="n">optional</span> <span class="o">--</span><span class="n">mesagl</span> <span class="o">--</span><span class="n">parallel</span> \
 <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">visit</span> <span class="o">--</span><span class="n">thirdparty</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span> \
 <span class="o">--</span><span class="n">makeflags</span> <span class="o">-</span><span class="n">j6</span>
</pre></div>
</div>
<p>This built the third party libraries and generated a <code class="docutils literal notranslate"><span class="pre">tr-fe2.cmake</span></code>
config site file. The <code class="docutils literal notranslate"><span class="pre">Setup</span> <span class="pre">VISITHOME</span> <span class="pre">&amp;</span> <span class="pre">VISITARCH</span> <span class="pre">variables.</span></code> section
was changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Setup VISITHOME &amp; VISITARCH variables.</span>
<span class="c1">##</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITHOME</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">SET</span><span class="p">(</span><span class="n">VISITARCH</span> <span class="n">linux</span><span class="o">-</span><span class="n">x86_64_gcc</span><span class="o">-</span><span class="mf">8.2</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_SLIVR</span> <span class="n">TRUE</span> <span class="n">TYPE</span> <span class="n">BOOL</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">VISIT_C_FLAGS</span></code> and <code class="docutils literal notranslate"><span class="pre">VISIT_CXX_FLAGS</span></code> were changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_C_FLAGS</span> <span class="s2">&quot; -m64 -fPIC -fvisibility=hidden -B/usr/projects/views/visit/thirdparty_shared/3.0.1/binutils/bin&quot;</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_CXX_FLAGS</span> <span class="s2">&quot; -m64 -fPIC -fvisibility=hidden -B/usr/projects/views/visit/thirdparty_shared/3.0.1/binutils/bin&quot;</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Parallel</span> <span class="pre">build</span> <span class="pre">Setup.</span></code> section was changed to</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Parallel Build Setup.</span>
<span class="c1">##</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_PARALLEL</span> <span class="n">ON</span> <span class="n">TYPE</span> <span class="n">BOOL</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_CXX_FLAGS</span> <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">cray</span><span class="o">/</span><span class="n">pe</span><span class="o">/</span><span class="n">mpt</span><span class="o">/</span><span class="mf">7.7</span><span class="o">.</span><span class="mi">4</span><span class="o">/</span><span class="n">gni</span><span class="o">/</span><span class="n">mpich</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="mf">7.1</span><span class="o">/</span><span class="n">include</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_C_FLAGS</span>   <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">cray</span><span class="o">/</span><span class="n">pe</span><span class="o">/</span><span class="n">mpt</span><span class="o">/</span><span class="mf">7.7</span><span class="o">.</span><span class="mi">4</span><span class="o">/</span><span class="n">gni</span><span class="o">/</span><span class="n">mpich</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="mf">7.1</span><span class="o">/</span><span class="n">include</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_LD_FLAGS</span>  <span class="s2">&quot;-L/opt/cray/pe/mpt/7.7.4/gni/mpich-gnu/7.1/lib -Wl,-rpath=/opt/cray/pe/mpt/7.7.4/gni/mpich-gnu/7.1/lib&quot;</span> <span class="n">TYPE</span> <span class="n">STRING</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_MPI_LIBS</span>     <span class="n">mpich</span><span class="p">)</span>
<span class="n">VISIT_OPTION_DEFAULT</span><span class="p">(</span><span class="n">VISIT_PARALLEL_RPATH</span>  <span class="s2">&quot;/opt/cray/pe/mpt/7.7.4/gni/mpich-gnu/7.1/lib&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="https://visit.llnl.gov">VisIt</a> was then manually built with the following steps.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tar</span> <span class="n">zxf</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cp</span> <span class="n">tr</span><span class="o">-</span><span class="n">fe2</span><span class="o">.</span><span class="n">cmake</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">config</span><span class="o">-</span><span class="n">site</span>
<span class="n">cd</span> <span class="n">visit3</span><span class="o">.</span><span class="mf">0.1</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">views</span><span class="o">/</span><span class="n">visit</span><span class="o">/</span><span class="n">thirdparty_shared</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">cmake</span><span class="o">/</span><span class="mf">3.9</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">x86_64_gcc</span><span class="o">-</span><span class="mf">8.2</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cmake</span> \
<span class="o">../</span><span class="n">src</span> <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="p">:</span><span class="n">STRING</span><span class="o">=</span><span class="n">Release</span> \
<span class="o">-</span><span class="n">DVISIT_INSTALL_THIRD_PARTY</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">DVISIT_PARADIS</span><span class="p">:</span><span class="n">BOOL</span><span class="o">=</span><span class="n">ON</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">8</span> <span class="n">package</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../BuildingOnWindows/index.html" class="btn btn-neutral float-right" title="19. Building on Windows" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Advanced_Usage.html" class="btn btn-neutral" title="18.2. Advanced Usage" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2008-2019, LLNL, UCRL-SM-220449.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2.11',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>