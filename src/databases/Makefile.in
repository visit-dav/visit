#                         Copyright (c) 2000 - 2007
#                 The Regents of the University of California
#            Produced at the Lawrence Livermore National Laboratory
#            Written by Sean Ahern, Kathleen Bonnell, Eric Brugger,
#           Hank Childs, Jeremy Meredith, Mark Miller, Brad Whitlock
#                              UCRL-CODE-220908
#                            All rights reserved.
#
# This file is part of VisIt. For details, see http://www.llnl.gov/visit/.
#
# Redistribution  and  use  in  source  and  binary  forms,  with  or  without
# modification, are permitted provided  that the following conditions are met:
#
# - Redistributions of  source code  must retain  the above  copyright notice,
#   this list of conditions and the disclaimer below.
# - Redistributions in binary form must  reproduce the above copyright notice,
#   this  list of  conditions  and  the  disclaimer  (as noted below)  in  the
#   documentation and/or materials provided with the distribution.
# - Neither the name of the  UC/LLNL nor the names of  its contributors may be
#   used to endorse  or promote products  derived from  this software  without
#   specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE  COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
# AND ANY EXPRESS OR  IMPLIED WARRANTIES,  INCLUDING, BUT NOT  LIMITED TO, THE
# IMPLIED WARRANTIES  OF MERCHANTABILITY AND FITNESS FOR  A PARTICULAR PURPOSE
# ARE  DISCLAIMED.  IN  NO  EVENT  SHALL  THE  REGENTS  OF  THE  UNIVERSITY OF
# CALIFORNIA, THE U.S. DEPARTMENT OF ENERGY  OR CONTRIBUTORS BE LIABLE FOR ANY
# DIRECT, INDIRECT,  INCIDENTAL, SPECIAL, EXEMPLARY, OR  CONSEQUENTIAL DAMAGES
# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
# LOSS OF USE, DATA, OR PROFITS; OR  BUSINESS INTERRUPTION) HOWEVER CAUSED AND
# ON ANY THEORY OF  LIABILITY, WHETHER IN CONTRACT, STRICT  LIABILITY, OR TORT
# (INCLUDING  NEGLIGENCE OR  OTHERWISE) ARISING IN ANY  WAY OUT OF  THE USE OF
# THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
# Additional BSD Notice
#
# 1. This notice is required  to be provided under our  contract with the U.S.
#    Department of Energy  (DOE). This work was produced  at the University of
#    California,  Lawrence Livermore National  Laboratory  under Contract  No.
#    W-7405-ENG-48 with the DOE.
#
# 2. Neither the  United States Government  nor the  University of  California
#    nor any of their  employees, makes  any warranty, express  or implied, or
#    assumes any liability  or responsibility for the  accuracy, completeness,
#    or  usefulness  of  any  information,   apparatus,  product,  or  process
#    disclosed, or represents that its  use would not infringe privately-owned
#    rights.
#
# 3. Also, reference herein  to any specific commercial  products, process, or
#    services by trade  name, trademark,  manufacturer  or otherwise  does not
#    necessarily  constitute  or imply  its  endorsement,  recommendation,  or
#    favoring by the United States Government or the University of California.
#    The views and  opinions of authors  expressed herein  do not  necessarily
#    state or reflect those of the  United States Government or the University
#    of  California,  and  shall  not  be  used  for  advertising  or  product
#    endorsement purposes.
#
# Programmer:  Jeremy Meredith
# Date:        August 21, 2002
#
# Modifications:
#
#   Hank Childs, Thu Oct  3 11:01:23 PDT 2002
#   Add a reader for Tetrad.
#
#   Hank Childs, Sun Oct 13 21:23:52 PDT 2002
#   Added a KullLite reader based on work by Akira Haddox.
#
#   Brad Whitlock, Mon Oct 14 16:34:22 PST 2002
#   Added the PDB reader.
#
#   Sean Ahern, Fri Nov 15 15:20:20 PST 2002
#   Added the ability for some databases to be "optional", just like
#   operators.  Not sure this will be used, but...
#
#   Hank Childs, Tue Mar 11 15:48:01 PST 2003
#   Added Spheral++ reader.  Point of contact is Mike Owen.
#
#   Hank Childs, Sat Mar 15 14:18:02 PST 2003
#   Added Points3D reader.  Point of contact is Bill Moran.
#
#   Jeremy Meredith, Tue Apr  8 13:18:29 PDT 2003
#   Added sample readers Rect and Hex.
#
#   Hank Childs, Fri Apr 11 07:25:27 PDT 2003
#   Added Mili reader.
#
#   Hank Childs, Tue Apr 22 16:19:42 PDT 2003
#   Added EnSight reader.
#
#   Jeremy Meredith, Wed May  7 14:00:19 PDT 2003
#   Removed PDB reader.  It should be added to the "PDB" target class
#   if we want it again.
#
#   Hank Childs, Mon May 12 22:36:20 PDT 2003
#   Added BOV reader.
#
#   Akira Haddox, Thu Jun 12 10:12:47 PDT 2003
#   Added Cosmos reader.
#
#   Eric Brugger, Mon Jun 16 12:57:17 PDT 2003
#   Make the building of the BOV reader optional.
#
#   Hank Childs, Tue Jun 17 10:07:15 PDT 2003
#   Do not require that HDF4 be available.  Modified BOV to depend on ZLIB.
#
#   Eric Brugger, Thu Jul  3 17:15:39 PDT 2003
#   Make the building of the BOV reader required.
#
#   Hank Childs, Mon Aug 11 15:51:54 PDT 2003
#   Add PLOT2D.
#
#   Akira Haddox, Fri Aug  8 10:50:10 PDT 2003
#   Added Boxlib2D, Boxlib3D readers.
#
#   Brad Whitlock, Tue Nov 25 13:50:19 PST 2003
#   Added reader for ANALYZE.
#
#   Hank Childs, Mon Nov 24 09:33:18 PST 2003
#   Added Cosmos++.
#
#   Chris Wojtan, Tue Jun 15 15:46:54 PDT 2004
#   Added Image file format reader.
#
#   Hank Childs, Thu Jun 24 12:46:07 PDT 2004
#   Remove Vista from the required format list to the HDF5 list.
#
#   Mark C. Miller, Wed Jul 21 11:19:15 PDT 2004
#   Added Vista back to required format list since it no longer
#   requires HDF5 in order to build. It can now be built with Silo AND HDF5
#   or with Silo only
#
#   Jeremy Meredith, Wed Jul 21 17:44:55 PDT 2004
#   Added OVERFLOW.  It depends on no other libraries.
#
#   Brad Whitlock, Fri Aug 13 14:29:40 PST 2004
#   Added Pixie.
#
#   Jeremy Meredith, Mon Aug 23 14:54:51 PDT 2004
#   Added the Dune plugin.
#
#   Jeremy Meredith, Wed Aug 25 11:56:21 PDT 2004
#   Added SimDB, needed for simulation support.
#
#   Mark C. Miller, Tue Sep 28 19:57:42 PDT 2004
#   Added ViSUS
#
#   Jeremy Meredith, Fri Dec 10 13:39:08 PST 2004
#   Tools are now run directly instead of as an argument to visit.
# 
#   Jeremy Meredith, Wed Nov 17 11:24:23 PST 2004
#   Added TecPlot.
#
#   Brad Whitlock, Fri Dec 17 13:26:46 PST 2004
#   Added CMAT reader.
#
#   Jeremy Meredith, Mon Jan  3 12:46:10 PST 2005
#   Added Enzo reader, which uses HDF4.  At some point it may also use HDF5.
#
#   Hank Childs, Sun Feb 13 13:35:13 PST 2005
#   Added SAR reader (SAR-> Specific Absorption Rate).
#
#   Jeremy Meredith, February 16, 2005
#   Changed captilization of Tecplot.
#
#   Brad Whitlock, Tue Feb 22 19:22:24 PST 2005
#   Added TFT reader.
#
#   Jeremy Meredith, Thu Mar 10 12:37:54 PST 2005
#   Renamed SimDB to SimV1 to make versioning explicit.
#
#   Brad Whitlock, Tue Mar 29 09:40:08 PDT 2005
#   Added Shapefile reader for ESRI shape files, which are popular in
#   GIS visualization.
#
#   Brad Whitlock, Fri Jun 17 15:03:29 PST 2005
#   Added Mark's AUXFile reader.
#
#   Brad Whitlock, Wed Jul 6 16:04:28 PST 2005
#   Added NASTRAN and ANSYS readers.
#
#   Hank Childs, Wed Jul 20 16:01:09 PDT 2005
#   Add Xmdv reader.
#
#   Brad Whitlock, Thu Jul 28 13:47:03 PST 2005
#   Added PATRAN reader.
#
#   Brad Whitlock, Tue Aug 9 17:42:08 PST 2005
#   Added netCDF support and a reader for it.
#
#   Jeremy Meredith, Tue Aug 23 13:27:44 PDT 2005
#   Added a FLASH reader.
#
#   Brad Whitlock, Tue Aug 30 15:59:31 PST 2005
#   Added a CGNS reader.
#
#   Brad Whitlock, Tue Sep 6 11:37:20 PDT 2005
#   Added a GDAL reader.
#
#   Hank Childs, Tue Dec 13 15:45:32 PST 2005
#   Added Miranda reader.
#
#   Mark C. Miller, Thu Dec 15 07:30:03 PST 2005
#   Temporarily removed Miranda from build
#
#   Brad Whitlock, Fri Jan 13 13:47:09 PST 2006
#   Added ZeusMP reader.
#
#   Hank Childs, Thu Jan 19 09:40:30 PST 2006
#   Added Chombo reader.
#
#   Jeremy Meredith, Wed Mar 22 13:46:20 PST 2006
#   Added ProteinDataBank reader
#
#   Brad Whitlock, Fri Mar 31 14:31:42 PST 2006
#   Added BOW and TSurf readers
#
#   Brad Whitlock, Thu Apr 27 13:16:09 PST 2006
#   Added ORNL points (GTC) format.
#
#   Hank Childs, Fri Jun  9 16:27:50 PDT 2006
#   Added MFIX reader.
#
#   Brad Whitlock, Wed Jul 12 17:26:47 PST 2006
#   Added MM5 reader and Vis5D reader.
#
#   Brad Whitlock, Thu Jul 20 11:54:34 PDT 2006
#   Added FITS reader.
#
#   Jeremy Meredith, Wed Jul 26 17:21:58 EDT 2006
#   Added VASP and CTRL molecular formats.
#
#   Tom Fogal, Fri Sep  1 15:58:15 PDT 2006
#   Added the GGCM reader.
#
#   Hank Childs, Fri Sep  8 14:33:44 PDT 2006
#   Added the Fluent reader (for Brian Dotson and Terry Jordan).
#
#   Brad Whitlock, Thu Nov 9 14:00:40 PST 2006
#   Added SimV1Writer plugin.
#
#   Mark C. Miller, Sun Dec  3 12:20:11 PST 2006
#   Removed reference to SAF
#
#   Dave Bremer, Thu Feb 22 12:03:34 PST 2007
#   Added Miranda RAW reader
#
#   Sean Ahern, Fri Apr  6 09:00:55 PDT 2007
#   Added the S3D reader.
#
#   Brad Whitlock, Thu May 17 13:54:01 PST 2007
#   Added Dyna3D reader.
#
#   Gunther H. Weber, Mon May 21 16:49:55 PDT 2007
#   Added Cristina Siegerist's H5Nimrod plugin
#
#   Gunther H. Weber, Mon May 21 17:35:35 PDT 2007
#   Added Cristina Siegerist's H5Part plugin
#
#   Jeremy Meredith, Tue May 22 11:40:38 EDT 2007
#   Added "MINIMAL" subset of plugins.
#
#   Gunther H. Weber, Tue May 22 10:20:31 PDT 2007
#   Merged Jeremy's last change (Tue May 22 11:40:38 EDT 2007) and my
#   last change (Mon May 21 17:35:35 PDT 2007).
#
##############################################################################

@SET_MAKE@
@VARIABLES@
all: message
	for dir in $(SUBDIRS); do (cd $$dir && $(MAKE) $@) || exit 1; done

BOXLIB2D=Boxlib2D
BOXLIB3D=Boxlib3D
CFITSIO=FITS
CGNS=CGNS
EXODUS=Exodus TimeVaryingExodus
GDAL=GDAL
HDF4=Cosmos Enzo ZeusMP
HDF5=Tetrad SAMRAI CosmosPP Pixie FLASH Chombo GTC H5Nimrod
MILI=Mili
NETCDF=NETCDF S3D
PDB=KullLite PDB
ITAPS=iTaps
VISUS=ViSUS
H5PART=H5Part

SAMPLES=Rect Hex

OPTIONAL=

REQUIRED=\
 ANALYZE \
 ANSYS \
 AUXFile \
 BOV \
 BOW \
 CMAT \
 CTRL \
 Curve2D \
 Dune \
 Dyna3D \
 EnSight \
 GGCM \
 Fluent \
 Image \
 Lines \
 MFIX \
 Miranda \
 MM5 \
 NASTRAN \
 OpenFOAM \
 OVERFLOW \
 PATRAN \
 PLOT2D \
 PLOT3D \
 Point3D \
 ProteinDataBank \
 SAMI \
 SAR \
 STL \
 Shapefile \
 Silo \
 SimV1 \
 SimV1Writer \
 Spheral \
 TFT \
 TSurf \
 Tecplot \
 VASP \
 Vis5D \
 Vista \
 VTK \
 WavefrontOBJ \
 Xmdv

# The following is a minimal subset of the OPTIONAL/REQUIRED plugins
MINIMAL=Curve2D Silo VTK

THIRDPARTY_DEPENDENT=@EXODUS@ @HDF4@ @HDF5@ @PDB@ @MILI@ @BOXLIB2D@ @BOXLIB3D@ @VISUS@ @NETCDF@ @CGNS@ @GDAL@ @CFITSIO@ @ITAPS@ @H5PART@

SUBDIRS=@DB_BUILD_DIRS@
ALLSUBDIRS=$(REQUIRED) $(EXODUS) $(HDF4) $(HDF5) $(MILI) $(PDB) $(BOXLIB2D) $(BOXLIB3D) $(VISUS) $(NETCDF) $(CGNS) $(GDAL) $(CFITSIO) $(ITAPS) $(H5PART) $(SAMPLES) $(OPTIONAL)

message:
	@echo
	@echo "****************************************************************************"
	@echo "****************************************************************************"
	@echo "***"
	@echo "*** Building Databases"
	@echo "***"
	@echo "****************************************************************************"
	@echo "****************************************************************************"


dirmakefiles:
	for dir in $(ALLSUBDIRS); do if test -d $$dir; then (cd $$dir && ../../bin/xml2makefile -noprint -clobber $${dir}.xml) || exit 1; fi; done

clean:
	-$(RM) $(LIB)
	for dir in $(SUBDIRS); do (cd $$dir && test ! -f Makefile || $(MAKE) $@) || exit 1; done
	-$(RM) $(CLEAN_FILES)

distclean: clean
	if test -n "$(SUBDIRS)"; then \
		rev=""; for dir in $(SUBDIRS); do rev="$$dir $$rev"; done; \
		for dir in $$rev; do (cd $$dir && test ! -f Makefile || $(MAKE) $@); done \
	fi
	-$(RM) $(DISTCLEAN_FILES) *~ .depend core
	-$(RM) Makefile

depend: dirmakefiles
	for dir in $(SUBDIRS); do (cd $$dir && $(MAKE) $@) || exit 1; done

checkdep: dirmakefiles
	for dir in $(SUBDIRS); do (cd $$dir && $(MAKE) $@) || exit 1; done

